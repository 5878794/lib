{"version":3,"sources":["select_infinite_cascade.es6"],"names":[],"mappings":"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","file":"select_infinite_cascade-compiled.js","sourcesContent":["\n//无限级联select\n//数据格式见下面注释的模拟数据\n//new DEVICE.infiniteCascadeSelect({\n//    id:\"test\",                //要插入的dom的id\n//    data:selectData,          //数据源\n//    hiddenInputName:\"aaa\"     //获取数据的input的name\n//})\n\n\n\nDEVICE.infiniteCascadeSelect = class select{\n    constructor(opt){\n        this.data = opt.data;\n        this.id = opt.id;\n        this.hiddenInputName = opt.hiddenInputName || \"test\";\n\n        this.index = -1;\n        this.dom = $(\"#\"+this.id);\n        this.hiddenInput = null;\n        this._init();\n    }\n\n    _init(){\n        this._addHiddenInput();\n        this._addSelect(this.data);\n    }\n\n    //增加隐藏input  取值用\n    _addHiddenInput(){\n        this.hiddenInput = $(\"<input type='hidden' name='\"+this.hiddenInputName+\"'></input>\");\n        this.dom.append(this.hiddenInput);\n    }\n\n    //在最后创建一个select\n    _addSelect(data,notSelect){\n        this.index++;\n\n        var select = $(\"<select></select>\");\n\n        select.append(\"<option value=''>请选择</option>\");\n        select.data({data:data,index:this.index});\n\n        let childrenData = [];\n\n        for(let i=0,l=data.length;i<l;i++){\n            let val = data[i].key,\n                name = data[i].val,\n                selected = (data[i].checked == \"true\"),\n                children = data[i].children || [];\n\n            selected = (notSelect)? false : selected;\n\n            if(selected){\n                select.append(\"<option value='\"+val+\"' selected>\"+name+\"</option>\");\n                this._setHiddenInputVal(val);\n                childrenData = children;\n            }else{\n                select.append(\"<option value='\"+val+\"'>\"+name+\"</option>\");\n            }\n        }\n\n        this.dom.append(select);\n        this._addEvent(select);\n\n        if(childrenData.length !=0){\n            this._addSelect(childrenData);\n        }\n    }\n\n    //事件监听\n    _addEvent(dom){\n        var _this = this;\n\n        dom.change(function(){\n            let index = $(this).data(\"index\"),\n                data = $(this).data(\"data\"),\n                childrenData = _this._getChildrenData($(this),data),\n                val = $(this).val();\n\n            _this._setHiddenInputVal(val);\n            _this._selectChange(index,childrenData);\n        })\n    }\n\n\n    //获取当前select的子集\n    _getChildrenData(select,data){\n        let val = select.val(),\n            backData = [];\n\n        for(let i=0,l=data.length;i<l;i++){\n            let this_data = data[i],\n                this_key = this_data.key,\n                this_val = this_data.val;\n\n            if(val == this_key){\n                backData = this_data.children || [];\n                break;\n            }\n        }\n        return backData;\n    }\n\n    //删除该元素后的select\n    _delAfterSelect(index){\n        let selects = this.dom.find(\"select\");\n        for(let i=0,l=selects.length;i<l;i++){\n            if(i>index){\n                let this_select = selects.eq(i);\n                this_select.unbind(\"change\")\n                           .remove();\n            }\n        }\n    }\n\n    //change事件处理\n    _selectChange(index,data){\n        this._delAfterSelect(index);\n        if(data.length !=0){\n            this._addSelect(data,true);\n        }\n    }\n\n    //设置隐藏input的val\n    _setHiddenInputVal(val){\n        this.hiddenInput.val(val);\n    }\n};\n\n\n\n//\n//var selectData = [\n//    {\n//        key:\"22\",\n//        val:\"22\",\n//        checked:\"true\",\n//        children:[\n//            {\n//                checked:\"false\",\n//                key:\"2211\",\n//                val:\"2211\"\n//            },\n//            {\n//                checked:\"true\",\n//                key:\"2212\",\n//                val:\"2212\",\n//                children:[\n//                    {\n//                        checked:\"false\",\n//                        key:\"2213\",\n//                        val:\"2213\",\n//                        children:[\n//                            {\n//                                checked:\"false\",\n//                                key:\"2214\",\n//                                val:\"2214\",\n//                                children:[\n//                                    {\n//                                        checked:\"false\",\n//                                        key:\"2215\",\n//                                        val:\"2215\"\n//                                    }\n//                                ]\n//                            },\n//                            {\n//                                checked:\"false\",\n//                                key:\"2211\",\n//                                val:\"2211\"\n//                            }\n//                        ]\n//                    },\n//                    {\n//                        checked:\"false\",\n//                        key:\"2223\",\n//                        val:\"2211\"\n//                    },\n//                ]\n//            },\n//            {\n//                checked:\"false\",\n//                key:\"2213\",\n//                val:\"2213\"\n//            }]\n//    },\n//    {\n//        key:\"33\",\n//        val:\"33\",\n//        checked:\"false\",\n//        children:[{\n//            checked:\"false\",\n//            key:\"3311\",\n//            val:\"3311\"\n//        }]\n//    }\n//];\n//\n//var dd;\n//$(document).ready(function(){\n//    dd = new DEVICE.infiniteCascadeSelect({\n//        id:\"test\",\n//        data:selectData,\n//        hiddenInputName:\"aaa\"\n//    })\n//});"]}