{"version":3,"sources":["select_infinite_cascade.es6"],"names":[],"mappings":"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","file":"select_infinite_cascade-compiled.js","sourcesContent":["\n//无限级联select\n//数据格式见下面注释的模拟数据\n//new DEVICE.infiniteCascadeSelect({\n//    id:\"test\",                //要插入的dom的id\n//    data:selectData,          //数据源\n//    hiddenInputName:\"aaa\"     //获取数据的input的name\n//})\n\n\n\nDEVICE.infiniteCascadeSelect = class select{\n    constructor(opt){\n        this.data = opt.data;\n        this.id = opt.id;\n        this.hiddenInputName = opt.hiddenInputName || \"test\";\n\n        this.index = -1;\n        this.dom = $(\"#\"+this.id);\n        this.hiddenInput = null;\n        this._init();\n    }\n\n    _init(){\n        this._addHiddenInput();\n        this._addSelect(this.data);\n    }\n\n    //增加隐藏input  取值用\n    _addHiddenInput(){\n        this.hiddenInput = $(\"<input type='hidden' name='\"+this.hiddenInputName+\"'></input>\");\n        this.dom.append(this.hiddenInput);\n    }\n\n    //在最后创建一个select\n    _addSelect(data,notSelect){\n        this.index++;\n\n        var select = $(\"<select></select>\");\n\n        select.append(\"<option value=''>请选择</option>\");\n        select.data({data:data,index:this.index});\n\n        let childrenData = [];\n\n        for(let i=0,l=data.length;i<l;i++){\n            let val = data[i].key,\n                name = data[i].val,\n                selected = (data[i].checked == \"true\"),\n                children = data[i].children || [];\n\n            selected = (notSelect)? false : selected;\n\n            if(selected){\n                select.append(\"<option value='\"+val+\"' selected>\"+name+\"</option>\");\n                this._setHiddenInputVal(val);\n                childrenData = children;\n            }else{\n                select.append(\"<option value='\"+val+\"'>\"+name+\"</option>\");\n            }\n        }\n\n        this.dom.append(select);\n        this._addEvent(select);\n\n        if(childrenData.length !=0){\n            this._addSelect(childrenData);\n        }\n    }\n\n    //事件监听\n    _addEvent(dom){\n        var _this = this;\n\n        dom.change(function(){\n            let index = $(this).data(\"index\"),\n                data = $(this).data(\"data\"),\n                childrenData = _this._getChildrenData($(this),data),\n                val = $(this).val();\n\n            _this._setHiddenInputVal(val);\n            _this._selectChange(index,childrenData);\n        })\n    }\n\n\n    //获取当前select的子集\n    _getChildrenData(select,data){\n        let val = select.val(),\n            backData = [];\n\n        for(let i=0,l=data.length;i<l;i++){\n            let this_data = data[i],\n                this_key = this_data.key,\n                this_val = this_data.val;\n\n            if(val == this_key){\n                backData = this_data.children || [];\n                break;\n            }\n        }\n        return backData;\n    }\n\n    //删除该元素后的select\n    _delAfterSelect(index){\n        let selects = this.dom.find(\"select\");\n        for(let i=0,l=selects.length;i<l;i++){\n            if(i>index){\n                let this_select = selects.eq(i);\n                this_select.unbind(\"change\")\n                           .remove();\n            }\n        }\n    }\n\n    //change事件处理\n    _selectChange(index,data){\n        this._delAfterSelect(index);\n        if(data.length !=0){\n            this._addSelect(data,true);\n        }\n    }\n\n    //设置隐藏input的val\n    _setHiddenInputVal(val){\n        this.hiddenInput.val(val);\n    }\n};\n\n\n\n//\n//var selectData = [\n//    {\n//        key:\"22\",\n//        val:\"22\",\n//        checked:\"true\",\n//        children:[\n//            {\n//                checked:\"false\",\n//                key:\"2211\",\n//                val:\"2211\"\n//            },\n//            {\n//                checked:\"true\",\n//                key:\"2212\",\n//                val:\"2212\",\n//                children:[\n//                    {\n//                        checked:\"false\",\n//                        key:\"2213\",\n//                        val:\"2213\",\n//                        children:[\n//                            {\n//                                checked:\"false\",\n//                                key:\"2214\",\n//                                val:\"2214\",\n//                                children:[\n//                                    {\n//                                        checked:\"false\",\n//                                        key:\"2215\",\n//                                        val:\"2215\"\n//                                    }\n//                                ]\n//                            },\n//                            {\n//                                checked:\"false\",\n//                                key:\"2211\",\n//                                val:\"2211\"\n//                            }\n//                        ]\n//                    },\n//                    {\n//                        checked:\"false\",\n//                        key:\"2223\",\n//                        val:\"2211\"\n//                    },\n//                ]\n//            },\n//            {\n//                checked:\"false\",\n//                key:\"2213\",\n//                val:\"2213\"\n//            }]\n//    },\n//    {\n//        key:\"33\",\n//        val:\"33\",\n//        checked:\"false\",\n//        children:[{\n//            checked:\"false\",\n//            key:\"3311\",\n//            val:\"3311\"\n//        }]\n//    }\n//];\n//\n//var dd;\n//$(document).ready(function(){\n//    dd = new DEVICE.infiniteCascadeSelect({\n//        id:\"test\",\n//        data:selectData,\n//        hiddenInputName:\"aaa\"\n//    })\n//});"]}